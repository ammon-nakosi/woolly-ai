#!/usr/bin/env node
const { spawn } = require('child_process');
const path = require('path');
const os = require('os');

const command = process.argv[2];
const scriptPath = path.join(os.homedir(), '.woolly', 'bin', 'chromadb-server.py');
const venvPython = path.join(os.homedir(), '.woolly', 'venv', 'bin', 'python');

if (command === 'start') {
  console.log('Starting ChromaDB server...');
  const child = spawn(venvPython, [scriptPath], {
    stdio: 'inherit',
    detached: false
  });
  
  child.on('error', (err) => {
    console.error('Failed to start ChromaDB:', err);
    process.exit(1);
  });
} else if (command === 'stop') {
  console.log('To stop ChromaDB, press Ctrl+C in the terminal where it\'s running');
} else {
  console.log('Usage: woolly chromadb [start|stop]');
}
